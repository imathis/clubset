<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>JSSpec results</title>
    <link rel="stylesheet" href="assets/JSSpec.css" type="text/css" />
    <script src="assets/diff_match_patch.js" type="text/javascript"></script>
    <script src="assets/JSSpec.js" type="text/javascript"></script>
    <script src="../prototype.lite.js" type="text/javascript"></script>
    <script src="../clubset.js" type="text/javascript"></script>
    <script type="text/javascript">
    // <![CDATA[
      Game.imagePath = '../images/';
      
      function cardsEqual(a,b) {
        if (!a.compareValue) a.compareValue = a.image + String(a.count);
        if (!b.compareValue) b.compareValue = b.image + String(b.count);
        return a.compareValue == b.compareValue;
      };
      
      describe('Game', {
        'before': function() {with(self){
          game = new Game();
        }},
        
        'should have a table': function() {with(self){
          expect(game.table).should_not_be(null);
        }},
        
        'should deal twelve cards to the table, removing them from the deck': function() {with(self){
          game.table.deal();
          expect(game.table.cards.length).should_be(12);
          expect(game.table.deck.cards.length).should_be(69);
        }},
        
        'should deal different cards on each deal': function() {with(self) {
          game.table.deal();
          game2 = new Game();
          game2.table.deal();
          
          var equalInAllPositions = true;
          game2.table.cards.forEach(function(card, index) {
            equalInAllPositions = equalInAllPositions && cardsEqual(card, game.table.cards[index]);
          });
          expect(equalInAllPositions).should_be(false);
        }}
      });
      
      describe('Deck', {
        'before': function() {with(self){
          game = new Game();
        }},
        
        'should have 81 cards, each with a different face': function() {with(self){
          expect(game.table.deck.cards.length).should_be(81);
          expect(typeof game.table.deck.cards[0]).should_not_be('undefined');
          
          var seen = new Array();
          game.table.deck.cards.forEach(function(card) {
            seen.forEach(function(seenCard) {
              expect(cardsEqual(card, seenCard)).should_be(false);
            });
            seen.push(card);
          });
        }}
      });
      
      describe('Card', {
        'should have an image': function() {with(self){
          expect(new Card('square', 'pink', 'dirt', 4).image).should_be('square-pink-dirt.png');
        }}
      });
      
      describe('Table', {
        
        'table should have a deck': function() {with(self){
          expect(game.table.deck).should_not_be(null);
        }},
        
        'should build all cards according to face': function() {with(self){
          var table = new Table();
          table.cards = [new Card('club', 'blue', 'stripe', 3)];
          table.build();
          
          expect($('table')).should_not_be(null);
          expect(document.getElementsByClassName('card').length).should_be(1);
          expect(document.getElementsByClassName('face').length).should_be(1);
          expect(document.getElementsByClassName('mark').length).should_be(3);
        }}
      });
    // ]]>
    </script>
  </head>
  <body>
  </body>
</html>